import Uploader from './editorjs-uploader.js';

const LOADER_DELAY = 500;
export default class OldAddress {
	// constructor({ data, config, api, block }) {
	constructor(params) {
		this.api = params.api;

		this.nodes = {
			wrapper: null,
			wrapper_check1: null,
			wrapper_check2: null,

			wrapper_input1: null,
			wrapper_input2: null,
			wrapper_input3: null,
			wrapper_input4: null,
			wrapper_input5: null,
			wrapper_input6: null,

			// params for response
			check_row1_title: null,
			check_row1_text: null,
			check_row1_className: null,
			check_row1_info: null,

			address_visible: null,
			address_label: null,

			address_className: null, //  input className prop
			address_inputClassName: null, // input inputClassName prop
			address_labelClassName: null, // labelClassName prop
			address_inputWrapperClassName: null, // inputWrapperClassName
			address_isRequired: null, // isRequired
			address_items: null, // items

			line2_visible: null,
			line2_label: null,
			line2_dropdownClass: null,
			line2_className: null,
			line2_inputClassName: null,
			line2_labelClassName: null,
			line2_inputWrapperClassName: null,
			line2_isRequired: null,

			city_visible: null,
			city_label: null,
			city_className: null,
			city_inputClassName: null,
			city_labelClassName: null,
			city_inputWrapperClassName: null,
			city_isRequired: null,

			state_visible: null,
			state_validation: null,
			state_label: null,
			state_className: null,
			state_inputClassName: null,
			state_labelClassName: null,
			state_inputWrapperClassName: null,
			state_isRequired: null,

			zip_visible: null,
			zip_validation: null,
			zip_label: null,
			zip_className: null,
			zip_inputClassName: null,
			zip_labelClassName: null,
			zip_inputWrapperClassName: null,
			zip_isRequired: null,
		};

		this.config = {
			endpoint: params.config.endpoint || '',
			field: params.config.field || 'image',
			types: params.config.types || 'image/*',
			namePlaceholder: params.config.namePlaceholder || 'Name',
			descriptionPlaceholder: params.config.descriptionPlaceholder || 'Description',
			linkPlaceholder: params.config.linkPlaceholder || 'Link',
		};

		/**
		 * Set saved state
		 */
		this.data = params.data;

		this.config.uploader = params.config.uploader;
		this.uploader = new Uploader({
			config: this.config,
			getCurrentFile: () => this.data.secureIcon,
			onUpload: (response) => this.onUpload({ body: response }),
			onError: (error) => this.uploadingFailed(error),
		});

		this.onUpload = (response) => {
			const {
				body: { success, file },
			} = response;

			if (success && file && file.url) {
				this.data.secureIcon = file.url;

				this.showFullImage();
			}
			// super.onUpload(response);
			params.block.save().then((state) => {
				params.api.blocks.update(state.id, state.data);
			});
		};
	}

	onUpload(response) {
		const {
			body: { success, file },
		} = response;

		if (success && file && file.url) {
			this.data.secureIcon = file.url;

			this.showFullImage();
		}
	}

	static get toolbox() {
		return {
			title: 'Old Address',
			icon: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>`,
		};
	}

	render() {
		const settingsIcon = this.make('img', 'settingsIcon', {
			src: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiByeD0iNSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwIDYuMjVWNU0xMCA2LjI1QzkuNjY4NDggNi4yNSA5LjM1MDU0IDYuMzgxNyA5LjExNjEyIDYuNjE2MTJDOC44ODE3IDYuODUwNTQgOC43NSA3LjE2ODQ4IDguNzUgNy41QzguNzUgNy44MzE1MiA4Ljg4MTcgOC4xNDk0NiA5LjExNjEyIDguMzgzODhDOS4zNTA1NCA4LjYxODMgOS42Njg0OCA4Ljc1IDEwIDguNzVNMTAgNi4yNUMxMC4zMzE1IDYuMjUgMTAuNjQ5NSA2LjM4MTcgMTAuODgzOSA2LjYxNjEyQzExLjExODMgNi44NTA1NCAxMS4yNSA3LjE2ODQ4IDExLjI1IDcuNUMxMS4yNSA3LjgzMTUyIDExLjExODMgOC4xNDk0NiAxMC44ODM5IDguMzgzODhDMTAuNjQ5NSA4LjYxODMgMTAuMzMxNSA4Ljc1IDEwIDguNzVNNi4yNSAxMy43NUM2LjU4MTUyIDEzLjc1IDYuODk5NDYgMTMuNjE4MyA3LjEzMzg4IDEzLjM4MzlDNy4zNjgzIDEzLjE0OTUgNy41IDEyLjgzMTUgNy41IDEyLjVDNy41IDEyLjE2ODUgNy4zNjgzIDExLjg1MDUgNy4xMzM4OCAxMS42MTYxQzYuODk5NDYgMTEuMzgxNyA2LjU4MTUyIDExLjI1IDYuMjUgMTEuMjVNNi4yNSAxMy43NUM1LjkxODQ4IDEzLjc1IDUuNjAwNTQgMTMuNjE4MyA1LjM2NjEyIDEzLjM4MzlDNS4xMzE3IDEzLjE0OTUgNSAxMi44MzE1IDUgMTIuNUM1IDEyLjE2ODUgNS4xMzE3IDExLjg1MDUgNS4zNjYxMiAxMS42MTYxQzUuNjAwNTQgMTEuMzgxNyA1LjkxODQ4IDExLjI1IDYuMjUgMTEuMjVNNi4yNSAxMy43NVYxNU02LjI1IDExLjI1VjVNMTAgOC43NVYxNU0xMy43NSAxMy43NUMxNC4wODE1IDEzLjc1IDE0LjM5OTUgMTMuNjE4MyAxNC42MzM5IDEzLjM4MzlDMTQuODY4MyAxMy4xNDk1IDE1IDEyLjgzMTUgMTUgMTIuNUMxNSAxMi4xNjg1IDE0Ljg2ODMgMTEuODUwNSAxNC42MzM5IDExLjYxNjFDMTQuMzk5NSAxMS4zODE3IDE0LjA4MTUgMTEuMjUgMTMuNzUgMTEuMjVNMTMuNzUgMTMuNzVDMTMuNDE4NSAxMy43NSAxMy4xMDA1IDEzLjYxODMgMTIuODY2MSAxMy4zODM5QzEyLjYzMTcgMTMuMTQ5NSAxMi41IDEyLjgzMTUgMTIuNSAxMi41QzEyLjUgMTIuMTY4NSAxMi42MzE3IDExLjg1MDUgMTIuODY2MSAxMS42MTYxQzEzLjEwMDUgMTEuMzgxNyAxMy40MTg1IDExLjI1IDEzLjc1IDExLjI1TTEzLjc1IDEzLjc1VjE1TTEzLjc1IDExLjI1VjUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K',
		});

		const settingWrapper = this.make('div', 'settingsWrapper');

		this.nodes.wrapper = this.make('div', this.CSS.wrapper);

		// Persona Info start
		this.nodes.wrapper_check1 = this.make('div', this.CSS.wrapper_check1);
		const wrpCheck = this.make('div', '');
		this.nodes.check_row1_title = this.make(
			'div',
			this.CSS.check_row2_title,
			{
				contentEditable: true,
			},
			this.data && this.data.check_row1_title ? this.data.check_row1_title : 'Old Address'
		);

		this.nodes.check_row1_text = this.make(
			'div',
			this.CSS.check_row1_text,
			{
				contentEditable: true,
			},
			this.data && this.data.check_row1_text ? this.data.check_row1_text : ''
		);

		var sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('check1');
		});
		var settingW = settingWrapper.cloneNode(true);
		var settingWW = this.make('div', 'check1');
		var lbl = this.make(
			'label',
			'',
			{
				for: 'check_row1_className',
			},
			'Class'
		);
		var inpt = this.make('input', '', {
			type: 'text',
			name: 'check_row1_className',
			value:
				this.data && this.data.check_row1_className ? this.data.check_row1_className : 'text-sm font-medium pr-5 py-3',
		});

		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'check1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'check_row1_info',
			},
			'Show Info button'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'check_row1_info',
			value: 'showInfo',
			checked: this.data && this.data.check_row1_info ? this.data.check_row1_info : false,
		});
		var btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('check1', 'save');
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);
		// end of Personal Infor Title
		this.nodes.wrapper_check1.appendChild(settingW);
		this.nodes.wrapper_check1.appendChild(sI);
		wrpCheck.appendChild(this.nodes.check_row1_title);
		wrpCheck.appendChild(this.nodes.check_row1_text);
		this.nodes.wrapper_check1.appendChild(wrpCheck);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_check1); // add Personal info title

		// Title Input with setting
		this.nodes.wrapper_input1 = this.make('div', this.CSS.wrapper_input1);

		this.nodes.address_label = this.make(
			'div',
			this.CSS.address_label,
			{
				contentEditable: true,
			},
			this.data && this.data.address_label ? this.data.address_label : 'Old Address'
		);

		sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('input1');
		});
		settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_visible',
			},
			'Show Input'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'address_visible',
			value: 'showInfo',
			checked: this.data.address_visible,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'autocomplete',
			},
			'Enable Autocomplete'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'autocomplete',
			value: 'showInfo',
			checked: this.data.autocomplete !== undefined ? this.data.autocomplete : true,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		// settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_className',
			},
			'Input Component Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'address_className',
			value: this.data && this.data.address_className ? this.data.address_className : 'justify-end pr-5 mt-5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_inputClassName',
			},
			'Input Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'address_inputClassName',
			value: this.data && this.data.address_inputClassName ? this.data.address_inputClassName : 'w-full',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_labelClassName',
			},
			'Label Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'address_labelClassName',
			value:
				this.data && this.data.address_labelClassName
					? this.data.address_labelClassName
					: 'text-right pr-1 justify-end',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_inputWrapperClassName',
			},
			'Wrapper Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'address_inputWrapperClassName',
			value:
				this.data && this.data.address_inputWrapperClassName
					? this.data.address_inputWrapperClassName
					: 'justify-end xl:w-2/3 lg:w-2/4 w-2/4',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input1');
		lbl = this.make(
			'label',
			'',
			{
				for: 'address_isRequired',
			},
			'Is Required ?'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'address_isRequired',
			value: 'showInfo',
			checked: this.data && this.data.address_isRequired ? this.data.address_isRequired : true,
		});

		btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('input1', 'save');
		});
		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);

		// settingWW = this.make('div', 'input1');
		// lbl = this.make('label', '', {
		//     for: 'address_items',
		// },
		//     'Items (separated by commas)'
		// );
		// inpt = this.make('input', '',{
		//     type: 'text',
		//     name: 'address_items',
		//     value: this.data && this.data.address_items ? this.data.address_items : 'Mr, Ms, Mrs',
		// });

		// settingWW.appendChild(lbl);
		// settingWW.appendChild(inpt);
		// settingWW.appendChild(btn);
		// settingW.appendChild(settingWW);

		this.nodes.wrapper_input1.appendChild(settingW);
		this.nodes.wrapper_input1.appendChild(sI);
		this.nodes.wrapper_input1.appendChild(this.nodes.address_label);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_input1); // add Title input with setttings
		let t = this.nodes.wrapper_input1.querySelector('[name=address_visible]');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input1.querySelector('[name="address_isRequired"]').checked = e.target.checked;
			this.nodes.wrapper_input1.classList.toggle('hidden');
		});

		t = this.nodes.wrapper_input1.querySelector('[name=address_isRequired');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input1.classList.toggle('required', e.target.checked);
		});

		// Title end

		// First Name start
		this.nodes.wrapper_input2 = this.make('div', 'cdx-moveDuration-wrapper-checkInput');

		this.nodes.line2_label = this.make(
			'div',
			'cdx-moveDuration-wrapper-Label',
			{
				contentEditable: true,
			},
			this.data && this.data.line2_label ? this.data.line2_label : 'Address Line 2'
		);

		sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('input2');
		});
		settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_visible',
			},
			'Show Input'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'line2_visible',
			value: 'showInfo',
			checked: this.data.line2_visible,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'showDropDown',
			},
			'Show Designators Dropdown'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'showDropDown',
			value: 'showInfo',
			checked: this.data.showDropDown !== undefined ? this.data.showDropDown : true,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_dropdownClass',
			},
			'Dropdown Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'line2_dropdownClass',
			value: this.data && this.data.line2_dropdownClass ? this.data.line2_dropdownClass : 'px-1 py-0.5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_className',
			},
			'Input Component Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'line2_className',
			value: this.data && this.data.line2_className ? this.data.line2_className : 'justify-end pr-5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_inputClassName',
			},
			'Input Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'line2_inputClassName',
			value: this.data && this.data.line2_inputClassName ? this.data.line2_inputClassName : 'w-full',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_labelClassName',
			},
			'Label Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'line2_labelClassName',
			value:
				this.data && this.data.line2_labelClassName ? this.data.line2_labelClassName : 'text-right pr-1 justify-end',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_inputWrapperClassName',
			},
			'Wrapper Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'line2_inputWrapperClassName',
			value:
				this.data && this.data.line2_inputWrapperClassName
					? this.data.line2_inputWrapperClassName
					: 'justify-end xl:w-2/3 lg:w-2/4 w-2/4',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input2');
		lbl = this.make(
			'label',
			'',
			{
				for: 'line2_isRequired',
			},
			'Is Required ?'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'line2_isRequired',
			value: 'showInfo',
			checked: this.data && this.data.line2_isRequired ? this.data.line2_isRequired : false,
		});

		btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('input2', 'save');
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);

		this.nodes.wrapper_input2.appendChild(settingW);
		this.nodes.wrapper_input2.appendChild(sI);
		this.nodes.wrapper_input2.appendChild(this.nodes.line2_label);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_input2); // add First Name input with setttings
		t = this.nodes.wrapper_input2.querySelector('[name=line2_visible]');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input2.querySelector('[name="line2_isRequired"]').checked = e.target.checked;
			this.nodes.wrapper_input2.classList.toggle('hidden');
		});

		t = this.nodes.wrapper_input2.querySelector('[name=line2_isRequired');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input2.classList.toggle('required', e.target.checked);
		});

		// First Name end

		// Last Name Start
		this.nodes.wrapper_input3 = this.make('div', 'cdx-moveDuration-wrapper-checkInput');

		this.nodes.city_label = this.make(
			'div',
			'cdx-moveDuration-wrapper-Label',
			{
				contentEditable: true,
			},
			this.data && this.data.city_label ? this.data.city_label : 'Old City'
		);

		sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('input3');
		});
		settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_visible',
			},
			'Show Input'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'city_visible',
			value: 'showInfo',
			checked: this.data.city_visible,
		});
		var btn = this.make('button', '', {}, 'Save');

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_className',
			},
			'Input Component Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'city_className',
			value: this.data && this.data.city_className ? this.data.city_className : 'justify-end pr-5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_inputClassName',
			},
			'Input Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'city_inputClassName',
			value: this.data && this.data.city_inputClassName ? this.data.city_inputClassName : 'w-full',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_labelClassName',
			},
			'Label Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'city_labelClassName',
			value: this.data && this.data.city_labelClassName ? this.data.city_labelClassName : 'text-right pr-1 justify-end',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_inputWrapperClassName',
			},
			'Wrapper Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'city_inputWrapperClassName',
			value:
				this.data && this.data.city_inputWrapperClassName
					? this.data.city_inputWrapperClassName
					: 'justify-end xl:w-2/3 lg:w-2/4 w-2/4',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input3');
		lbl = this.make(
			'label',
			'',
			{
				for: 'city_isRequired',
			},
			'Is Required ?'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'city_isRequired',
			value: 'showInfo',
			checked: this.data && this.data.city_isRequired ? this.data.city_isRequired : true,
		});
		btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('input3', 'save');
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);

		this.nodes.wrapper_input3.appendChild(settingW);
		this.nodes.wrapper_input3.appendChild(sI);
		this.nodes.wrapper_input3.appendChild(this.nodes.city_label);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_input3); // add Last Name input with setttings

		t = this.nodes.wrapper_input3.querySelector('[name=city_visible]');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input3.querySelector('[name="city_isRequired"]').checked = e.target.checked;
			this.nodes.wrapper_input3.classList.toggle('hidden');
		});

		t = this.nodes.wrapper_input3.querySelector('[name=city_isRequired');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input3.classList.toggle('required', e.target.checked);
		});
		// Last name end

		// Phone Start
		this.nodes.wrapper_input4 = this.make('div', 'cdx-moveDuration-wrapper-checkInput');

		this.nodes.state_label = this.make(
			'div',
			'cdx-moveDuration-wrapper-Label',
			{
				contentEditable: true,
			},
			this.data && this.data.state_label ? this.data.state_label : 'Old State'
		);

		sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('input4');
		});
		settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_visible',
			},
			'Show Input'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'state_visible',
			value: 'showInfo',
			checked: this.data.state_visible,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_className',
			},
			'Input Component Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'state_className',
			value: this.data && this.data.state_className ? this.data.state_className : 'justify-end pr-5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_inputClassName',
			},
			'Input Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'state_inputClassName',
			value: this.data && this.data.state_inputClassName ? this.data.state_inputClassName : 'w-full',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_labelClassName',
			},
			'Label Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'state_labelClassName',
			value:
				this.data && this.data.state_labelClassName ? this.data.state_labelClassName : 'text-right pr-1 justify-end',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_inputWrapperClassName',
			},
			'Wrapper Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'state_inputWrapperClassName',
			value:
				this.data && this.data.state_inputWrapperClassName
					? this.data.state_inputWrapperClassName
					: 'justify-end xl:w-2/3 lg:w-2/4 w-2/4',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input4');
		lbl = this.make(
			'label',
			'',
			{
				for: 'state_isRequired',
			},
			'Is Required ?'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'state_isRequired',
			value: 'showInfo',
			checked: this.data && this.data.state_isRequired ? this.data.state_isRequired : true,
		});

		btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('input4', 'save');
		});
		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);

		this.nodes.wrapper_input4.appendChild(settingW);
		this.nodes.wrapper_input4.appendChild(sI);
		this.nodes.wrapper_input4.appendChild(this.nodes.state_label);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_input4); // add Phone input with setttings
		t = this.nodes.wrapper_input4.querySelector('[name=state_visible]');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input4.querySelector('[name="state_isRequired"]').checked = e.target.checked;
			this.nodes.wrapper_input4.classList.toggle('hidden');
		});

		t = this.nodes.wrapper_input4.querySelector('[name=state_isRequired');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input4.classList.toggle('required', e.target.checked);
		});
		// Phone End

		// Email Start
		this.nodes.wrapper_input5 = this.make('div', 'cdx-moveDuration-wrapper-checkInput');

		this.nodes.zip_label = this.make(
			'div',
			'cdx-moveDuration-wrapper-Label',
			{
				contentEditable: true,
			},
			this.data && this.data.zip_label ? this.data.zip_label : 'Old Zip Code'
		);

		sI = settingsIcon.cloneNode(true);
		sI.addEventListener('click', () => {
			this._toggleTune('input5');
		});
		settingW = settingWrapper.cloneNode(true);
		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_visible',
			},
			'Show Input'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'zip_visible',
			value: 'showInfo',
			checked: this.data.zip_visible,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_className',
			},
			'Input Component Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'zip_className',
			value: this.data && this.data.zip_className ? this.data.zip_className : 'justify-end pr-5',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_inputClassName',
			},
			'Input Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'zip_inputClassName',
			value: this.data && this.data.zip_inputClassName ? this.data.zip_inputClassName : 'w-full',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_labelClassName',
			},
			'Label Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'zip_labelClassName',
			value: this.data && this.data.zip_labelClassName ? this.data.zip_labelClassName : 'text-right pr-1 justify-end',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_inputWrapperClassName',
			},
			'Wrapper Class'
		);
		inpt = this.make('input', '', {
			type: 'text',
			name: 'zip_inputWrapperClassName',
			value:
				this.data && this.data.zip_inputWrapperClassName
					? this.data.zip_inputWrapperClassName
					: 'justify-end xl:w-2/3 lg:w-2/4 w-2/4',
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(inpt);
		settingW.appendChild(settingWW);

		settingWW = this.make('div', 'input5');
		lbl = this.make(
			'label',
			'',
			{
				for: 'zip_isRequired',
			},
			'Is Required ?'
		);
		inpt = this.make('input', '', {
			type: 'checkbox',
			name: 'zip_isRequired',
			value: 'showInfo',
			checked: this.data && this.data.zip_isRequired ? this.data.zip_isRequired : true,
		});

		lbl.prepend(inpt);
		settingWW.appendChild(lbl);

		btn = this.make('button', '', {}, 'Save');
		btn.addEventListener('click', () => {
			this._toggleTune('input5', 'save');
		});
		settingWW.appendChild(lbl);
		settingWW.appendChild(btn);
		settingW.appendChild(settingWW);

		this.nodes.wrapper_input5.appendChild(settingW);
		this.nodes.wrapper_input5.appendChild(sI);
		this.nodes.wrapper_input5.appendChild(this.nodes.zip_label);
		this.nodes.wrapper.appendChild(this.nodes.wrapper_input5); // add Email input with setttings

		t = this.nodes.wrapper_input5.querySelector('[name=zip_visible]');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input5.querySelector('[name="zip_isRequired"]').checked = e.target.checked;
			this.nodes.wrapper_input5.classList.toggle('hidden');
		});

		t = this.nodes.wrapper_input5.querySelector('[name=zip_isRequired');
		t.addEventListener('change', (e) => {
			this.nodes.wrapper_input5.classList.toggle('required', e.target.checked);
		});

		// Email Stop

		// DOB start
		if (this.data && !this.data.address_visible) {
			this.nodes.wrapper_input1.classList.toggle('hidden');
		}
		if (this.data && !this.data.line2_visible) {
			this.nodes.wrapper_input2.classList.toggle('hidden');
		}
		if (this.data && !this.data.city_visible) {
			this.nodes.wrapper_input3.classList.toggle('hidden');
		}
		if (this.data && !this.data.state_visible) {
			this.nodes.wrapper_input4.classList.toggle('hidden');
		}
		if (this.data && !this.data.zip_visible) {
			this.nodes.wrapper_input5.classList.toggle('hidden');
		}

		if (this.data && this.data.address_isRequired) {
			this.nodes.wrapper_input1.classList.toggle('required');
		}
		if (this.data && this.data.line2_isRequired) {
			this.nodes.wrapper_input2.classList.toggle('required');
		}
		if (this.data && this.data.zip_isRequired) {
			this.nodes.wrapper_input3.classList.toggle('required');
		}
		if (this.data && this.data.state_isRequired) {
			this.nodes.wrapper_input4.classList.toggle('required');
		}
		if (this.data && this.data.zip_isRequired) {
			this.nodes.wrapper_input5.classList.toggle('required');
		}

		// DOB end

		return this.nodes.wrapper;
	}
	// save(blockContent) {
	// 	return {
	// 		url: blockContent.value,
	// 	};
	// }
	setFullImageSource(image) {
		const imageUrlWithToken = this.uploader.config.uploader.addTokenToURL(image) + '';
		//	this.nodes.secureIcon.style.background = `url('${imageUrlWithToken}') center center / cover no-repeat`;
		this.nodes.secureIcon.src = imageUrlWithToken;
	}

	showFullImage() {
		setTimeout(() => {
			this.nodes.secureIcon.classList.remove(this.CSS.loader);
			this.setFullImageSource(this.data.secureIcon);
		}, LOADER_DELAY);
	}

	save(toolsContent) {
		// params for response
		const check_row1_title = this.nodes.check_row1_title.textContent;
		const check_row1_text = this.nodes.check_row1_text.textContent;
		const check_row1_className = toolsContent.querySelector('[name=check_row1_className]').value;
		const check_row1_info = toolsContent.querySelector('[name=check_row1_info]').checked;

		const autocomplete = toolsContent.querySelector('[name=autocomplete]').checked;
		const showDropDown = toolsContent.querySelector('[name=showDropDown]').checked;
		const address_visible = toolsContent.querySelector('[name=address_visible]').checked;
		const address_label = toolsContent
			.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[0]
			.querySelector('[contenteditable="true"]').textContent;
		const address_className = toolsContent.querySelector('[name=address_className]').value;
		const address_inputClassName = toolsContent.querySelector('[name=address_inputClassName]').value;
		const address_labelClassName = toolsContent.querySelector('[name=address_labelClassName]').value;
		const address_inputWrapperClassName = toolsContent.querySelector('[name=address_inputWrapperClassName]').value;
		const address_isRequired = toolsContent.querySelector('[name=address_isRequired]').checked;
		// const address_items  = toolsContent.querySelector('[name=address_items]').value;

		const line2_visible = toolsContent.querySelector('[name=line2_visible]').checked;
		const line2_label = toolsContent
			.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[1]
			.querySelector('[contenteditable="true"]').textContent;
		const line2_className = toolsContent.querySelector('[name=line2_className]').value;
		const line2_dropdownClass = toolsContent.querySelector('[name=line2_dropdownClass]').value;
		const line2_inputClassName = toolsContent.querySelector('[name=line2_inputClassName]').value;
		const line2_labelClassName = toolsContent.querySelector('[name=line2_labelClassName]').value;
		const line2_inputWrapperClassName = toolsContent.querySelector('[name=line2_inputWrapperClassName]').value;
		const line2_isRequired = toolsContent.querySelector('[name=line2_isRequired]').checked;

		const city_visible = toolsContent.querySelector('[name=city_visible]').checked;
		const city_label = toolsContent
			.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[2]
			.querySelector('[contenteditable="true"]').textContent;
		const city_className = toolsContent.querySelector('[name=city_className]').value;
		const city_inputClassName = toolsContent.querySelector('[name=city_inputClassName]').value;
		const city_labelClassName = toolsContent.querySelector('[name=city_labelClassName]').value;
		const city_inputWrapperClassName = toolsContent.querySelector('[name=city_inputWrapperClassName]').value;
		const city_isRequired = toolsContent.querySelector('[name=city_isRequired]').checked;

		const state_visible = toolsContent.querySelector('[name=state_visible]').checked;
		// const state_validation= toolsContent.querySelector('[name=state_validation]').checked;
		const state_label = toolsContent
			.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[3]
			.querySelector('[contenteditable="true"]').textContent;
		const state_className = toolsContent.querySelector('[name=state_className]').value;
		const state_inputClassName = toolsContent.querySelector('[name=state_inputClassName]').value;
		const state_labelClassName = toolsContent.querySelector('[name=state_labelClassName]').value;
		const state_inputWrapperClassName = toolsContent.querySelector('[name=state_inputWrapperClassName]').value;
		const state_isRequired = toolsContent.querySelector('[name=state_isRequired]').checked;

		const zip_visible = toolsContent.querySelector('[name=zip_visible]').checked;
		//  const zip_validation = toolsContent.querySelector('[name=zip_validation]').checked;
		const zip_label = toolsContent
			.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[4]
			.querySelector('[contenteditable="true"]').textContent;
		const zip_className = toolsContent.querySelector('[name=zip_className]').value;
		const zip_inputClassName = toolsContent.querySelector('[name=zip_inputClassName]').value;
		const zip_labelClassName = toolsContent.querySelector('[name=zip_labelClassName]').value;
		const zip_inputWrapperClassName = toolsContent.querySelector('[name=zip_inputWrapperClassName]').value;
		const zip_isRequired = toolsContent.querySelector('[name=zip_isRequired]').checked;

		/**
		 * Fill missing fields with empty strings
		 */

		Object.assign(this.data, {
			check_row1_title: check_row1_title.trim() || '',
			check_row1_text: check_row1_text.trim() || '',
			check_row1_className: check_row1_className.trim() || '',
			check_row1_info: check_row1_info,
			address_visible: address_visible,
			address_label: address_label.trim() || '',
			address_className: address_className.trim() || '',
			address_inputClassName: address_inputClassName.trim() || '',
			address_labelClassName: address_labelClassName.trim() || '',
			address_inputWrapperClassName: address_inputWrapperClassName.trim() || '',
			address_isRequired: address_isRequired,
			// address_items : address_items.trim() || '',
			line2_visible: line2_visible,
			line2_label: line2_label.trim() || '',
			line2_className: line2_className.trim() || '',
			line2_inputClassName: line2_inputClassName.trim() || '',
			line2_labelClassName: line2_labelClassName.trim() || '',
			line2_dropdownClass: line2_dropdownClass.trim() || '',
			line2_inputWrapperClassName: line2_inputWrapperClassName.trim() || '',
			line2_isRequired: line2_isRequired,
			city_visible: city_visible,
			city_label: city_label.trim() || '',
			city_className: city_className.trim() || '',
			city_inputClassName: city_inputClassName.trim() || '',
			city_labelClassName: city_labelClassName.trim() || '',
			city_inputWrapperClassName: city_inputWrapperClassName.trim() || '',
			city_isRequired: city_isRequired,
			state_visible: state_visible,
			state_label: state_label.trim() || '',
			state_className: state_className.trim() || '',
			state_inputClassName: state_inputClassName.trim() || '',
			state_labelClassName: state_labelClassName.trim() || '',
			state_inputWrapperClassName: state_inputWrapperClassName.trim() || '',
			state_isRequired: state_isRequired,
			zip_visible: zip_visible,
			zip_label: zip_label.trim() || '',
			zip_className: zip_className.trim() || '',
			zip_inputClassName: zip_inputClassName.trim() || '',
			zip_labelClassName: zip_labelClassName.trim() || '',
			zip_inputWrapperClassName: zip_inputWrapperClassName.trim() || '',
			zip_isRequired: zip_isRequired,
			autocomplete: autocomplete,
			showDropDown: showDropDown,
		});
		return this.data;
	}

	stopLoading() {
		setTimeout(() => {
			this.nodes.secureIcon.classList.remove(this.CSS.loader);
			this.nodes.secureIcon.removeAttribute('style');
		}, LOADER_DELAY);
	}

	/**
	 * Show loader when file upload started
	 */
	addLoader() {
		this.nodes.secureIcon.style.background = 'none';
		this.nodes.secureIcon.classList.add(this.CSS.loader);
	}

	/**
	 * If file uploading failed, remove loader and show notification
	 * @param {string} errorMessage -  error message
	 */
	uploadingFailed(errorMessage) {
		this.stopLoading();

		this.api.notifier.show({
			message: errorMessage,
			style: 'error',
		});
	}

	get CSS() {
		return {
			baseClass: this.api.styles.block,
			input: this.api.styles.input,
			loader: this.api.styles.loader,

			/**
			 * Tool's classes
			 */
			wrapper: 'cdx-moveDuration-wrapper',
			wrapper_check1: 'cdx-moveDuration-wrapper-check',
			wrapper_check2: 'cdx-moveDuration-wrapper-check',
			wrapper_input1: 'cdx-moveDuration-wrapper-checkInput',
			wrapper_input2: 'cdx-moveDuration-wrapper-checkInput',
			wrapper_input3: 'cdx-moveDuration-wrapper-checkInput',

			check_row1_title: 'cdx-moveDuration-wrapper-checkTitle',
			check_row2_title: 'cdx-moveDuration-wrapper-checkTitle',

			check_row1_text: 'cdx-moveDuration-wrapper-checkText',
			check_row2_text: 'cdx-moveDuration-wrapper-checkText',

			start_label: 'cdx-moveDuration-wrapper-Label',
			start2_label: 'cdx-moveDuration-wrapper-Label',
			stop_label: 'cdx-moveDuration-wrapper-Label',
		};
	}

	validate(savedData) {
		/**
		 * Return false if fields are empty
		 */
		return (
			savedData.check_row1_title ||
			savedData.check_row1_text ||
			savedData.check_row1_className ||
			savedData.check_row1_info ||
			savedData.address_visible ||
			savedData.address_label ||
			savedData.address_className ||
			savedData.address_inputClassName || // input inputClassName prop
			savedData.address_labelClassName || // labelClassName prop
			savedData.address_inputWrapperClassName || // inputWrapperClassName
			savedData.address_isRequired || // isRequired
			savedData.line2_visible ||
			savedData.line2_label ||
			savedData.line2_className ||
			savedData.line2_inputClassName ||
			savedData.line2_labelClassName ||
			savedData.line2_dropdownClass ||
			savedData.line2_inputWrapperClassName ||
			savedData.line2_isRequired ||
			savedData.city_visible ||
			savedData.city_label ||
			savedData.city_className ||
			savedData.city_inputClassName ||
			savedData.city_labelClassName ||
			savedData.city_inputWrapperClassName ||
			savedData.city_isRequired ||
			savedData.state_visible ||
			savedData.state_label ||
			savedData.state_className ||
			savedData.state_inputClassName ||
			savedData.state_labelClassName ||
			savedData.state_inputWrapperClassName ||
			savedData.state_isRequired ||
			savedData.zip_visible ||
			savedData.zip_label ||
			savedData.zip_className ||
			savedData.zip_inputClassName ||
			savedData.zip_labelClassName ||
			savedData.zip_inputWrapperClassName ||
			savedData.zip_isRequired ||
			savedData.autocomplete ||
			savedData.showDropDown
		);
	}

	make(tagName, classNames = null, attributes = {}, content = '') {
		const el = document.createElement(tagName);

		if (Array.isArray(classNames)) {
			el.classList.add(...classNames);
		} else if (classNames) {
			el.classList.add(classNames);
		}

		for (const attrName in attributes) {
			el[attrName] = attributes[attrName];
		}
		if (content !== '') {
			el.innerHTML = content;
		}

		return el;
	}

	_toggleTune(tune, type = '') {
		if (type == '') {
			for (var item of this.nodes.wrapper.querySelectorAll('.settingsWrapper')) {
				item.classList.remove('active');
			}
		}
		if (tune == 'check1') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-check')[0]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'check2') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-check')[1]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input1') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[0]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input2') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[1]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input3') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[2]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input4') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[3]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input5') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[4]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		if (tune == 'input6') {
			this.nodes.wrapper
				.querySelectorAll('.cdx-moveDuration-wrapper-checkInput')[5]
				.querySelector('.settingsWrapper')
				.classList.toggle('active');
		}
		// }
	}
}
